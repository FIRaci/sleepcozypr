:root {
    /* Colors */
    --color-primary: #f0e68c;
    --color-secondary: #302b63;
    --color-background: #0f0c29;
    --color-text: #E0E0E0;

    /* Sizing */
    --sidebar-width: 320px;
    --nav-width: 60px;
    --header-height: 64px;
}

html { scroll-behavior: smooth; }

body {
    font-family: 'Quicksand', sans-serif;
    color: var(--color-text);
    background-color: var(--color-background);
    overflow-x: hidden;
}

body.loading .sidebar-container {
    transition: none !important;
    visibility: hidden;
}

/* --- Custom Scrollbar Styling --- */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: rgba(30, 28, 58, 0.5); }
::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--color-primary); }
#ambient-sounds-grid::-webkit-scrollbar, #ai-chat-box::-webkit-scrollbar { width: 4px; }
#ambient-sounds-grid::-webkit-scrollbar-thumb, #ai-chat-box::-webkit-scrollbar-thumb { background: #6b7280; }

.swiper-slide { scrollbar-width: none; -ms-overflow-style: none; }

/* --- Language Switcher --- */
#language-switcher-button:focus + #language-options,
#language-options:hover {
    display: block;
}

/* --- Dynamic Background & Effects --- */
.bg-gradient { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; transition: background 0.8s ease-in-out; overflow: hidden;}
.theme-default .bg-gradient { background: linear-gradient(180deg, #0f0c29, #302b63, #24243e); }
.theme-sunset .bg-gradient { background: linear-gradient(180deg, #3B4371, #F3904F); }
.theme-dawn .bg-gradient { background: linear-gradient(180deg, #83a4d4, #b6fbff); }
.theme-beach .bg-gradient { background: linear-gradient(180deg, #87CEEB 60%, #4682B4 100%); }

.star { position: absolute; background-color: white; border-radius: 50%; animation: twinkle 3s infinite ease-in-out alternate; will-change: opacity; transition: opacity 0.5s; }
body.deep-night .star { opacity: 1 !important; animation-duration: 2s; } 
@keyframes twinkle { from { opacity: 0.3; } to { opacity: 1; } }

.theme-beach .star, .theme-dawn .star { display: none; }
.theme-beach .shooting-star, .theme-dawn .shooting-star {display: none;}
.theme-beach #moon, .theme-dawn #moon { display: none; } 
.theme-default #sun, .theme-sunset #sun { display: none; } 


.shooting-star {
  position: absolute;
  width: 2px;
  height: 80px;
  background: linear-gradient(-45deg, white, transparent);
  opacity: 0;
  animation: shooting 2s ease-in-out;
  z-index: -1;
  will-change: transform, opacity;
}
@keyframes shooting {
  0% { opacity: 0; transform: translate(0,0) rotate(45deg); }
  10% { opacity: 1; }
  100% { transform: translate(-300px,300px) rotate(45deg); opacity: 0; }
}

#sun, #moon {
    position: absolute;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    transition: background-color 0.8s ease-in-out, box-shadow 0.8s ease-in-out, opacity 0.5s, top 0.2s linear, left 0.2s linear;
    will-change: top, left, opacity;
    display: none; 
}

#sun {
    background-color: #FFD700;
    box-shadow: 0 0 50px #FFD700, 0 0 100px #FFFACD;
    top: 10%;
    left: 15%;
}

#moon {
    background-color: var(--color-primary);
    box-shadow: 0 0 40px var(--color-primary), 0 0 80px #fdf4a6;
    overflow: hidden;
    top: 10%;
    right: 15%;
    left: auto; 
}

.theme-dawn #sun { background-color: #FFF4E3; box-shadow: 0 0 50px #FFF4E3, 0 0 100px #ffffff; }
.theme-sunset #moon { background-color: #FDB813; box-shadow: 0 0 50px #FDB813, 0 0 100px #ffda75; }

.moon-phase-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #0f0c29; 
    border-radius: 50%;
    transition: transform 0.5s ease-in-out;
}
.theme-sunset .moon-phase-overlay { background-color: #3B4371; }


/* --- Beach Theme Elements --- */
.cloud { position: absolute; background: white; border-radius: 50px; opacity: 0.8; animation: drift linear infinite; will-change: transform; }
.cloud::before, .cloud::after { content: ''; position: absolute; background: white; border-radius: 50%; }
.cloud::before { width: 60%; height: 120%; top: -60%; left: 10%; }
.cloud::after { width: 80%; height: 160%; top: -80%; right: 5%; }
@keyframes drift {
    from { transform: translateX(-200px); }
    to { transform: translateX(110vw); }
}

/* --- AI Assistant --- */
.ai-message { max-width: 85%; padding: 10px 15px; border-radius: 15px; line-height: 1.5; }
.ai-message.user { background-color: #302b63; border-bottom-right-radius: 3px; margin-left: auto; }
.ai-message.ai { background-color: #2c2854; border-bottom-left-radius: 3px; }
.ai-message strong { color: var(--color-primary); }
.ai-tip { font-size: 0.8rem; background-color: rgba(255, 255, 255, 0.05); border-left: 3px solid var(--color-primary); padding: 8px 12px; margin-top: 8px; border-radius: 0 8px 8px 0; }
.ai-thinking-dot { display: inline-block; width: 8px; height: 8px; background-color: var(--color-primary); border-radius: 50%; animation: ai-pulse 1.4s infinite ease-in-out both; }
@keyframes ai-pulse {
    0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); }
}
#ai-send-btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* --- Header & Navigation --- */
header { position: fixed; top: 0; left: 0; width: 100%; z-index: 30; background: rgba(15, 12, 41, 0.3); backdrop-filter: blur(10px); transition: background-color 0.3s ease; height: var(--header-height); }
.nav-link { position: relative; transition: color 0.3s; }
.nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 50%; transform: translateX(-50%); background-color: #fdf4a6; transition: width 0.3s ease; }
.nav-link:hover::after, .nav-link.active::after { width: 100%; }

/* --- Sections --- */
.section { min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 80px 20px; padding-top: var(--header-height); }
#home { padding-top: 80px; }

/* --- Cards Styling & Performance --- */
.feature-card, .stats-card, .pomodoro-card, header, .sidebar-container .swiper-slide, .tab-nav {
    background: rgba(255, 255, 255, 0.05);
}

@supports (backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px)) {
    .feature-card, .stats-card {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .pomodoro-card {
        -webkit-backdrop-filter: blur(15px);
        backdrop-filter: blur(15px);
        background: rgba(15, 12, 41, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    header, .sidebar-container .swiper-slide, .tab-nav, #mobile-menu, #edit-sound-modal > div, #restore-sounds-modal > div, #language-options {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        background: rgba(15, 12, 41, 0.6);
    }
    #edit-sound-modal > div, #restore-sounds-modal > div { background: rgba(30, 28, 62, 0.8); }
    header { background: rgba(15, 12, 41, 0.3); }
}

.feature-card:hover, .stats-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.2); }
.personal-stats-item .fa-fw { width: 1.5em; }

.theme-card { cursor: pointer; overflow: hidden; border: 2px solid rgba(255, 255, 255, 0.2); transition: all 0.3s ease; }
.theme-card img { transition: transform 0.4s ease; }
.theme-card:hover img { transform: scale(1.05); }
.theme-card.active { border-color: var(--color-primary); box-shadow: 0 0 20px rgba(240, 230, 140, 0.5); }

.pomodoro-mode-btn { background: transparent; border: 1px solid transparent; transition: all 0.3s ease; }
.pomodoro-mode-btn.active { background-color: rgba(240, 230, 140, 0.2); border-color: rgba(240, 230, 140, 0.5); color: var(--color-primary); }
.pomodoro-start-btn { background-color: var(--color-primary); color: #1a202c; box-shadow: 0 4px 15px rgba(240, 230, 140, 0.3); transition: all 0.3s ease; }
.pomodoro-start-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(240, 230, 140, 0.4), 0 0 15px rgba(240, 230, 140, 0.6); }

/* --- CTA Buttons & Micro-interactions --- */
.cta-button { transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
.cta-button:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.3), 0 0 15px rgba(240, 230, 140, 0.5); }
.cta-primary { background-color: var(--color-primary); color: #1a202c; }
.cta-primary:hover { background-color: #eadd78; }
.cta-secondary { background-color: transparent; border: 2px solid var(--color-primary); color: var(--color-primary); }
.cta-secondary:hover { background-color: rgba(240, 230, 140, 0.1); }

/* --- Accessibility --- */
button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, duet-date-picker:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  border-radius: 4px;
}

/* --- Alarm Sidebar --- */
.sidebar-container { position: fixed; left: 0; top: var(--header-height); height: calc(100vh - var(--header-height)); display: flex; z-index: 40; transform: translateX(calc(-1 * (var(--sidebar-width) + var(--nav-width)))); transition: transform 0.4s cubic-bezier(0.77, 0, 0.175, 1); }
body.sidebar-active .sidebar-container { transform: translateX(0); }
.swiper-container-vertical { width: var(--sidebar-width); height: 100%; }
.swiper-slide { display: flex; justify-content: center; align-items: flex-start; padding: 20px; padding-top: 40px; border-right: 1px solid rgba(255, 255, 255, 0.1); overflow-y: auto; }
#ambient-sounds-grid { overflow: visible; } /* Fix for menu clipping */


.tab-nav { width: var(--nav-width); border-right: 1px solid rgba(255, 255, 255, 0.1); display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 15px; }
.tab-nav-button { cursor: pointer; padding: 10px; border-radius: 8px; transition: all 0.2s; opacity: 0.6; }
.tab-nav-button:hover { opacity: 1; background-color: rgba(255,255,255,0.1); }
.tab-nav-button.active { opacity: 1; background-color: rgba(240, 230, 140, 0.3); box-shadow: 0 0 10px rgba(240, 230, 140, 0.5); }
.tab-nav-button i { font-size: 24px; }

/* --- General UI components --- */
.form-input, .form-select, .form-textarea, .custom-time-input { background-color: rgba(30,28,62,0.8); border: 1px solid #4a5568; border-radius: 8px; padding: 0.625rem; color: #E0E0E0; width: 100%; }
.form-input:focus, .form-select:focus, .form-textarea:focus, .custom-time-input:focus-within { outline: none; border-color: #fdf4a6; box-shadow: 0 0 0 2px rgba(253, 244, 166, 0.5); }
duet-date-picker { --duet-color-primary: #fdf4a6; --duet-color-text: #E0E0E0; --duet-color-background: rgba(30,28,62,0.8); --duet-color-surface: rgba(48, 43, 99, 0.9); --duet-border-radius: 8px; margin-bottom: 1rem; }

#mobile-menu { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
#mobile-menu.show { max-height: 300px; }

.toggle-switch { position: relative; display: inline-block; width: 50px; height: 28px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4a5568; transition: .4s; border-radius: 28px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--color-primary); }
input:checked + .slider:before { transform: translateX(22px); }

.time-picker-popover { background: rgba(48, 43, 99, 0.95); backdrop-filter: blur(5px); border: 1px solid #4a5568; }
.time-picker-column { height: 150px; overflow-y: scroll; scroll-snap-type: y mandatory; }
.time-picker-item { height: 30px; display: flex; align-items: center; justify-content: center; scroll-snap-align: center; cursor: pointer; }
.time-picker-item.selected { color: var(--color-primary); font-weight: 600; }

/* --- Relaxation Space & Audio Player --- */
.sound-card { 
    aspect-ratio: 1 / 1;
    position: relative; 
    cursor: pointer; 
    overflow: visible; /* Fix for menu clipping */
    border-radius: 0.75rem; 
    transition: all 0.3s ease; 
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    background-color: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
}
.sound-card:hover { transform: translateY(-5px); background-color: rgba(255, 255, 255, 0.1); }
.sound-card.playing { border-color: var(--color-primary); box-shadow: 0 0 15px rgba(240, 230, 140, 0.5); }

.sound-card-icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
.sound-card-name { font-weight: 600; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }

#add-sound-card { border-style: dashed; }
#add-sound-card:hover { border-color: var(--color-primary); color: var(--color-primary); }

.sound-options-btn { position: absolute; top: 8px; right: 8px; color: white; background: rgba(0,0,0,0.3); border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s; z-index: 11; }
.sound-options-btn:hover { background: rgba(0,0,0,0.6); }

.sound-options-menu { position: absolute; top: 40px; right: 8px; background: #2d3748; border-radius: 8px; padding: 4px; z-index: 10; display: none; width: max-content; }
.sound-options-menu button { display: block; width: 100%; text-align: left; padding: 8px 12px; font-size: 0.875rem; background: none; border: none; color: white; cursor: pointer; white-space: nowrap; }
.sound-options-menu button:hover { background-color: #4a5568; }
.sound-options-menu .favorite-star { color: #6b7280; }
.sound-options-menu .favorite-star.favorited { color: #facc15; }

.audio-player-container { position: fixed; bottom: -100px; left: 0; right: 0; background: rgba(15, 12, 41, 0.8); backdrop-filter: blur(10px); transition: bottom 0.5s cubic-bezier(0.23, 1, 0.32, 1); z-index: 50; }
.audio-player-container.show { bottom: 0; }
.player-close-btn { background: transparent; border: none; cursor: pointer; transition: transform 0.2s ease; }
.player-close-btn:hover { transform: scale(1.2); }

input[type=range] { -webkit-appearance: none; background: transparent; }
input[type=range]::-webkit-slider-runnable-track { height: 5px; background: #4a5568; border-radius: 5px; }
input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: var(--color-primary); margin-top: -5.5px; }

/* --- Mobile Optimization --- */
@media (max-width: 768px) {
  .section { padding: 60px 15px; padding-top: var(--header-height); }
  #clock { font-size: 3.5rem; }
  #theme-selector { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  #language-switcher {
    position: absolute;
    top: 100%;
    right: 1.5rem; /* 24px */
    background: rgba(15, 12, 41, 0.6);
    backdrop-filter: blur(10px);
    border-radius: 0 0 0.5rem 0.5rem;
    padding: 0.5rem;
  }
}
